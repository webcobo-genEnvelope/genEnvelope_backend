# 📨 전자봉투 시스템

전자봉투 시스템은 민감 정보를 안전하게 전달하고, 수신자가 내용의 진위를 검증할 수 있도록 돕는 보안 시스템입니다.

---

## ✅ 주요 기능 요약

| 기능 구분               | 설명                                                                 |
|------------------------|----------------------------------------------------------------------|
| 🔑 키 생성             | 사용자/검사기관의 RSA 키쌍을 생성하여 저장                             |
| 🧪 전자봉투 생성       | 검사 결과와 인증 마크에 전자서명 적용 → AES로 암호화하여 ZIP 생성       |
| 📥 전자봉투 받기       | ZIP 파일을 복호화 후 진위 여부 및 결과 출력                             |

---

## 🖥️ UI 화면

### 1️⃣ 키 생성 화면
<img src="images/ui_keygen.png" width="400"/>

- 이름 입력 → RSA 키쌍 자동 생성 (`data/영희private`, `data/영희public`)

---

### 2️⃣ 전자봉투 생성 화면
<img src="images/ui_create_envelope.png" width="400"/>

- 입력: 수신자 이름, 인증 마크 파일명, 검사 결과 텍스트
- 출력: `data/envelope.zip` 파일 자동 생성

---

### 3️⃣ 전자봉투 받기 (복호화 및 진위 확인)
<img src="images/ui_receive.png" width="400"/>

- 이름 입력 후 [검사 결과] 클릭 시:
  - 전자봉투 복호화
  - 진위 여부 판단
  - 검사 결과 출력

---

## 📦 전자봉투 구조

```
envelope.zip
├── 암호문.dat           # AES로 암호화된 ZIP 데이터
├── envelope.key         # 수신자의 공개키로 암호화된 AES 키
```

🔓 `암호문.dat` 복호화 후 내부 구성:

```
result.txt               # 검사 결과 원문
result.sig               # 결과에 대한 전자서명
certified_mark.png       # 인증 마크 이미지
mark.sig                 # 마크 이미지에 대한 전자서명
certificate.txt          # 검사기관의 인증서(공개키)
```

---

## 📎 시퀀스 다이어그램

```mermaid
sequenceDiagram
    participant 검사기관(철수)
    participant 사용자(영희)

    검사기관(철수)->>자신: 키쌍 생성
    검사기관(철수)->>시스템: 결과 + 마크 입력
    시스템->>검사기관: 서명 + 암호화
    시스템->>영희: envelope.zip 전송

    영희->>자신: 비밀키로 AES 키 복호화
    영희->>자신: AES 키로 암호문 복호화
    영희->>자신: 서명 검증 및 결과 확인
```

---

## 🧠 전자서명 흐름 요약

### ✔️ 서명 생성

- `result.txt`, `certified_mark.png` → 해시 → **개인키로 서명**
- `certificate.txt`: 검사기관의 공개키 포함

### ✔️ 서명 검증

- `certificate.txt`로 공개키 추출
- 서명 검증:
  - `result.sig` ↔ 해시(`result.txt`)
  - `mark.sig` ↔ 해시(`certified_mark.png`)
- 모두 일치 → **진본 확인됨**

---

## 📁 키 및 인증서 저장 구조

```
data/
├── 영희private        # 사용자 비밀키
├── 영희public         # 사용자 공개키
├── labPrivate         # 검사기관 비밀키
├── labPublic          # 검사기관 공개키
├── certificate.txt    # 검사기관 인증서 (공개키)
```

---

## 🧪 결과 예시

| 항목             | 결과                      |
|------------------|---------------------------|
| 진위 여부         | 진본 확인됨                |
| 결과 내용         | DNA 검사 결과 이상 없음    |

---

## 📌 실행 방법

```bash
# IntelliJ 또는 터미널에서 실행
# KeyEnvelopeUI.java → main() 실행
```

> 🔐 암호화, 전자서명, 인증서 기반 검증 로직을 **100% 순수 Java 코드로 구현**  
> 📂 파일 시스템 기반 전자봉투 구조 → 실제 행정/보험 전달 방식과 유사하게 모델링됨
